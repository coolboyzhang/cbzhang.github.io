webpackJsonp([11],{"./app/containers/MileStone/index.js":function(e,t,n){"use strict";function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments[1];switch(t.type){case S:return e;case M:return e.set("rawList",Object(O.fromJS)(t.data.list)).set("tags",Object(O.fromJS)(t.data.tags));case w:return e.set("selectTag",t.data.tag).set("list",Object(O.fromJS)(t.data.list));default:return e}}function o(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},N,this)}function r(e){return{data:e,type:M}}function a(e){return{data:e,type:w}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function c(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function u(e){return{queryMileStone:function(t){return e(r(t))},selectMileStone:function(t){return e(a(t))}}}Object.defineProperty(t,"__esModule",{value:!0});var d=n("./node_modules/react/index.js"),p=n.n(d),f=(n("./node_modules/prop-types/index.js"),n("./node_modules/react-redux/es/index.js")),m=n("./node_modules/react-helmet/lib/Helmet.js"),b=n("./node_modules/reselect/es/index.js"),j=n("./node_modules/redux/es/index.js"),v=n("./app/utils/injectSaga.js"),y=n("./app/utils/injectReducer.js"),g=function(e){return e.get("mileStone")},_=function(){return Object(b.a)(g,function(e){return e.toJS()})},h=_,O=n("./node_modules/immutable/dist/immutable.js"),S="app/MileStone/DEFAULT_ACTION",M="app/MileStone/QUERY_MILE_STONE_LIST",w="app/MileStone/SELECT_MILE_STONE_LIST",T=Object(O.fromJS)({list:{},rawList:[],tags:[],selectTag:""}),k=i,N=regeneratorRuntime.mark(o),x=n("./app/containers/App/selectors.js"),E=n("./node_modules/antd/lib/index.js"),Y=n("./app/utils/timer.js"),L=n("./app/utils/stringHelper.js"),D=n("./app/utils/recentlyUsed.js"),I=n("./app/utils/Storage.js"),A=n("./app/containers/App/index.js"),P=n("./app/utils/arrayHelper.js");n.d(t,"MileStone",function(){return U});var J=function(){var e="function"==typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103;return function(t,n,i,o){var r=t&&t.defaultProps,a=arguments.length-3;if(n||0===a||(n={}),n&&r)for(var s in r)void 0===n[s]&&(n[s]=r[s]);else n||(n=r||{});if(1===a)n.children=o;else if(a>1){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+3];n.children=l}return{$$typeof:e,type:t,key:void 0===i?null:""+i,ref:null,props:n,_owner:null}}}(),q=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),C=J(m.Helmet,{},void 0,J("title",{},void 0,"里程碑"),J("meta",{name:"jsososo",content:"里程碑"})),R=J(E.Select.Option,{value:""},void 0,"全部"),H=J("b",{className:"pl_20"},void 0,"Now"),U=function(e){function t(){return s(this,t),l(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),q(t,[{key:"componentDidMount",value:function(){Object(A.a)("里程碑")&&(D.a.set("里程碑","kit",this.props.user.username),this.getAllMileStone())}},{key:"getAllMileStone",value:function(){var e=this,t=this.props.user.username||"游客";I.a.queryBmob("Thing",function(e){return e.equalTo("user",t),e.equalTo("milestone",!0),e.limit(1e3),e},function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=[];n.push({id:"today",time:Object(Y.a)().time}),n.forEach(function(e){e.tag&&i.push(e.tag)}),i=P.a.delDuplicate(i),e.props.queryMileStone({list:n,tags:i}),e.selectMileStone(I.a.get("mile-stone-tag-"+t)),e.pageScroll()},function(){E.message.error("找不到呀")},"find")}},{key:"selectMileStone",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=this.props,n=t.milestone,i=t.selectMileStone,o=t.user,r={};I.a.set("mile-stone-tag-"+(o.username||"游客"),e),n.rawList.forEach(function(t){if(!e||t.tag===e||"today"===t.id){var n=Object(Y.a)(t.time).str();r[n]?r[n].push(t):r[n]=[t]}}),i({list:r,tag:e})}},{key:"pageScroll",value:function(){var e=Object(L.b)("id"),t=document.getElementById("milestone-"+e),n=t.parentNode.parentNode;t&&window.scrollTo(0,t.offsetTop+n.offsetTop-100)}},{key:"render",value:function(){var e=this,t=this.props.milestone;return J("div",{},void 0,C,J("div",{},void 0,J("div",{className:"mb_20"},void 0,"Tag：",J(E.Select,{className:"w_200 ml_20",value:t.selectTag,onChange:function(t){return e.selectMileStone(t)}},void 0,R,t.tags.map(function(e){return J(E.Select.Option,{value:e},"mile-stone-tag-"+e,e)}))),J(E.Timeline,{},void 0,Object.keys(t.list).sort(function(e,t){return Object(Y.a)(e,"YYYY-MM-DD").time-Object(Y.a)(t,"YYYY-MM-DD").time}).map(function(e){return J(E.Timeline.Item,{id:"milestone-date-"+e,color:Object(Y.a)().time<Object(Y.a)(e,"YYYY-MM-DD").time?"#999":"blue"},"milestone-date-"+e,t.list[e].map(function(e,t){return"today"===e.id?J("div",{className:"fc_blue ft_18 mb_10",id:"milestone-today"},"now",J("b",{style:{width:"150px"},className:"inline-block"},void 0,0===t&&Object(Y.a)(e.time).str()),H):J("div",{className:"mb_15",id:"milestone-"+e.objectId},"milestone-thing-"+e.objectId,J("div",{},void 0,J("b",{style:{width:"150px"},className:"ft_18 inline-block "+(e.time>Object(Y.a)().time?"fc_999":"fc_blue")},void 0,0===t&&Object(Y.a)(e.time).str()),J("a",{className:"mile-stone-link",href:"#/kit/calendar/?date="+Object(Y.a)(e.time).str()+"&id="+e.id},void 0,J("span",{className:"pl_20 ft_16",style:{fontWeight:"900"}},void 0,e.title||"还没起名字"),J("span",{className:"pl_20"},void 0,Object(Y.a)().to(Object(Y.a)(e.time),"str",2)))),J("div",{className:"fc_999",style:{paddingLeft:"170px"}},void 0,e.content))}))}))))}}]),t}(p.a.PureComponent),B=Object(b.b)({milestone:h(),user:Object(x.b)()}),$=Object(f.b)(B,u),F=Object(y.a)({key:"mileStone",reducer:k}),Q=Object(v.a)({key:"mileStone",saga:o});t.default=Object(j.c)(F,Q,$)(U)}});